# Common Configuration - Shared between Blue and Green deployments
# This file contains configuration that is the same across all environments

# === Application Settings ===
NODE_ENV=production
HOST=0.0.0.0

# === Email Service Configuration ===
EMAIL_SERVICE=smtp
SMTP_HOST=hermes.utia.cas.cz
SMTP_PORT=25
SMTP_SECURE=false
SMTP_REQUIRE_TLS=true
SMTP_AUTH=false
SMTP_USER=
SMTP_PASS=
FROM_EMAIL=spheroseg@utia.cas.cz
FROM_NAME="SpheroSeg"

# === Email Timeout Settings ===
EMAIL_TIMEOUT=300000
SMTP_CONNECTION_TIMEOUT_MS=15000
SMTP_GREETING_TIMEOUT_MS=15000
SMTP_SOCKET_TIMEOUT_MS=600000
EMAIL_GLOBAL_TIMEOUT=600000

# === Email Retry Configuration ===
EMAIL_MAX_RETRIES=2
EMAIL_RETRY_INITIAL_DELAY=1000
EMAIL_RETRY_MAX_DELAY=10000
EMAIL_RETRY_BACKOFF_FACTOR=2

# === Email Features ===
SKIP_EMAIL_SEND=false
REQUIRE_EMAIL_VERIFICATION=false
SMTP_IGNORE_TLS=false
EMAIL_ALLOW_INSECURE=false

# === JWT Configuration (same for both environments) ===
JWT_ACCESS_SECRET=your_jwt_access_secret_here
JWT_REFRESH_SECRET=your_jwt_refresh_secret_here

# === File Storage ===
STORAGE_TYPE=local
MAX_FILE_SIZE=10485760

# === Rate Limiting ===
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX=2000

# === Monitoring ===
OTEL_SAMPLING_RATE=0.1
ENABLE_TRACING=false

# === Upload Configuration ===
NGINX_BODY_LIMIT=500M

# === SSL/TLS Configuration ===
SSL_DOMAIN=spherosegapp.utia.cas.cz
SSL_CERT_PATH=/etc/letsencrypt/live/spherosegapp.utia.cas.cz

# === ML Service Parallel Processing Configuration ===
ML_INFERENCE_WORKERS=4
ML_INFERENCE_TIMEOUT=60
ML_MEMORY_LIMIT_GB=20
ML_ENABLE_CUDA_STREAMS=true
ML_ENABLE_MONITORING=true
ML_ENABLE_PARALLEL_INFERENCE=true
ML_MAX_CONCURRENT_USERS=4
ML_CONCURRENT_MODELS=3

# === Database Concurrency Enhancement ===
DATABASE_CONNECTION_POOL_SIZE=50
DATABASE_MAX_CONNECTIONS=75
DATABASE_POOL_TIMEOUT=30000
DATABASE_ENABLE_PARALLEL_QUERIES=true

# === WebSocket Scaling for Parallel Processing ===
WS_MAX_CONNECTIONS_PER_PROJECT=50
WS_CONCURRENT_PROCESSING_ROOMS=20
WS_PARALLEL_PROCESSING_ENABLED=true
WS_HEARTBEAT_INTERVAL=25000

# === Queue Processing Configuration ===
QUEUE_MAX_CONCURRENT_BATCHES=4
QUEUE_PARALLEL_PROCESSING_ENABLED=true
QUEUE_BATCH_SIZE_OPTIMIZATION=true
QUEUE_WORKER_INTERVAL=100

# === GPU Memory Management ===
GPU_MEMORY_RESERVE_PERCENT=20
GPU_MEMORY_WARNING_THRESHOLD=90
GPU_MEMORY_CRITICAL_THRESHOLD=95
GPU_ENABLE_MEMORY_MONITORING=true