# Nginx log rotation configuration for SpheroSeg
# Blue environment nginx logs - kept for 90 days for IT audit
/home/cvat/cell-segmentation-hub/logs/blue/nginx/access.log /home/cvat/cell-segmentation-hub/logs/blue/nginx/error.log {
    daily
    missingok
    rotate 90
    compress
    delaycompress
    notifempty
    create 0644 cvat cvat
    dateext
    dateformat -%Y-%m-%d
    sharedscripts
    postrotate
        # Reload nginx-blue container to reopen log files
        docker exec nginx-blue nginx -s reopen 2>/dev/null || true
    endscript
}

# Green environment nginx logs
/home/cvat/cell-segmentation-hub/logs/green/nginx/access.log /home/cvat/cell-segmentation-hub/logs/green/nginx/error.log {
    daily
    missingok
    rotate 90
    compress
    delaycompress
    notifempty
    create 0644 cvat cvat
    dateext
    dateformat -%Y-%m-%d
    sharedscripts
    postrotate
        # Reload nginx-green container to reopen log files
        docker exec nginx-green nginx -s reopen 2>/dev/null || true
    endscript
}